Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2023-01-31T16:50:18+02:00

====== Зашифровать ======

Шифровать надо диск ДО появления на нём данных. И уж тем более до создания RAID. Уже работающий диск придётся освободить от файлов и пересоздать на нём партицию уже с шифрованием.


Надо помнить, что 

* в быту обращение к зашифрованному диску потребует постоянного ввода пароля,
* зашифрованность диска обломит того, кто вытащит/украдёт диск из NAS и захочет его прочитать, но совершенно не остановит того, кто атакует компьютер через сеть, потому что после успешного логина и запуска OMV диски уже будут расшифрованы; поэтому особо секретные файлы надо дополнительно положить в криптоконтейнер и зашифровать ключом gpg — и пароли каждого уровня закрытия не должны повторяться, нигде и никак,
* шифрование HDD не остановит порядочного гражданина, который случайно захочет прогреть свой утюг на незашифрованной заднице счастливого владельца NAS.

Непременно надо шифровать криптокошельки и прочую бухгалтерию, но такое добро много места не занимает, оно может лежать в криптоконтейнере типа VeraCrypt. А если шифровывать такие файлы через ключи gpg, тогда криптоконтейнеры не собо нужен.

При шифровании небольшое торможение к дискам будет неизбежно, примерно такое же, как при использовании антивируса. Это не особо заметно, если файлы небольшие, но может быть заметным при копировании здоровенных файлов, потому что из-за шифрования растёт нагрузка на CPU. Если не знать о шифровании дисков, то это всё будет незаметно (фиксить только психологию). 

Есть неоднократное мнение о том, что из-за шифрования диски живут «меньше необходимого». Не могу это ни подтвердить, ни опровергнуть, известно только, что:
* шифрование SSD практически не снижает срок службы диска, если у нас современный SSD с нормальным TBW (Total Bytes Written, характеристика SSD которая указывает сколько данных можно всего записать на диск, прежде чем он официально исчерпает свой ресурс), и TRIM включён (discard работает) и в swap не записываются гигабайты данных каждый час,
* шифрование HDD еще проще, потому что у них нет ограниченного ресурса TBW и на них можно перезаписывать данные сколько угодно раз,
* само по себе шифрование не увеличивает объём записи, количество записанных байт не меняется, значит и нагрузка на диск не растёт.

===== Установить плагин LUKS =====

1. ''System > Plugins''
	a) Установить плагин //openmediavault-luksencryption//
	b) В разделе Storage появится новый пункт “Encryption”
2. ''Storage > Encryption > [+ Create]''
3. Вставить в систему диск, который надо зашифровать — полностью пустой, без файловой системы (партиция будет создана OMV).
4. Указать encryption key (не потерять его и не ошибиться при записи, потому что зашифрованные данные восстановлению не подлежат)
5. [Create / Apply / Yes]

Если надо зашифровать несколько дисков — повторить для каждого последовательно.

===== Сделать бэкап LUKS header =====

1. ''Storage > Encryption''
2. Выбрать нужный диск
3. Recovery
4. Выбрать Backup-header
5. Сохранить его, бо в будущем может понадобиться.

===== Разлочить диск =====

1. ''Storage > Encryption''
2. Выбрать нужный диск > [Unlock]
3. Указать пароль для расшифровки > [Unlock]
4. Синяя точка должна отметить, что диск расшифрован.

===== Создать партицию =====

1. ''Storage > Files Systems > [+ Create]''
2. Указать добавленный и расшифрованный диск
3. Указать label диска
4. Выбрать файловую систему из выпадающего меню
5. Mount
6. [Save / Apply / Yes]

Сделать каталоги для shares (или RAID) и тд.

//Вернуться//: [[Добавить HDD]]
