Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2023-01-31T16:50:18+02:00

====== Зашифровать HDD ======

Шифровать надо диск ДО появления на нём данных. И уж тем более до создания RAID.

Непременно надо шифровать криптокошельки и прочую бухгалтерию, но такое добро много места не занимает, оно может лежать в криптоконтейнере типа VeraCrypt. Также подобные файлы можно зашифровывать через ключи gpg, а тогда криптоконтейнеры не собо нужен.

Зашифрованность диска обломит того, кто вытащит/украдёт диск из NAS и захочет его прочитать, но совершенно не остановит того, кто атакует компьютер через сеть, потому что после успешного логина и запуска OMV диски уже будут расшифрованы. Также это не остановит того, кто захочет прогревать утюг на незашифрованной заднице счастливого владельца NAS.

При шифровании небольшое торможение к дискам будет неизбежно, примерно такое же, как при использовании антивируса. Это не особо заметно, если файлы небольшие, но может быть заметным при копировании здоровенных файлов, потому что из-за шифрования растёт нагрузка на CPU. Если не знать о шифровании дисков, то это всё будет незаметно (фиксить только психологию). 

Есть неоднократное мнение о том, что из-за шифрования диски живут «меньше необходимого». Не могу это ни подтвердить, ни опровергнуть, известно только, что:
* шифрование SSD практически не снижает срок службы диска, если у нас современный SSD с нормальным (Total Bytes Written, характеристика SSD которая указывает сколько данных можно всего записать на диск, прежде чем он официально исчерпает свой ресурс), TRIM включён (discard работает) и в swap не записываются гигабайты каждый день.
* шифрование HDD еще проще, потому что у них нет ограниченного ресурса TBW и на них можно перезаписывать данные сколько угодно раз.
* само по себе шифрование не увеличивает объём записи, количество записанных байт не меняется, значит и нагрузка на диск не растёт.

===== Установить плагин LUKS =====

1. ''System > Plugins''
	a) Установить плагин //openmediavault-luksencryption//
	b) В разделе Storage появится новый пункт “Encryption”
2. ''Storage > Encryption > [+ Create]''
3. Выбрать диск, который надо зашифровать (без данных и файловой системы).
4. Указать encryption key (не потерять и не ошибиться при записи, восстановлению не подлежит)
5. [Create / Apply / Yes]

Если надо зашифровать несколько дисков — повторить для каждого последовательно.

===== Сделать бэкап LUKS header =====

1. ''Storage > Encryption''
2. Выбрать нужный диск
3. Recovery
4. Выбрать Backup-header
5. Сохранить его, бо в будущем может понадобиться.

===== Разлочить диск =====

1. ''Storage > Encryption''
2. Выбрать нужный диск > [Unlock]
3. Указать пароль для расшифровки > [Unlock]
4. Синяя точка должна отметить, что диск расшифрован.

===== Отформатировать разлоченный диск =====

1. ''Storage > Files Systems > [+ Create]''
2. Указать добавленный и расшифрованный диск
3. Указать label диска
4. Выбрать файловую систему из выпадающего меню
5. Mount
6. [Save / Apply / Yes]

Дальше делать каталоги для обычных shares или RAID.

//Вернуться//: [[Добавить HDD]]
